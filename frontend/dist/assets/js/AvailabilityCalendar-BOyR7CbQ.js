var oe=Object.defineProperty,me=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var G=(s,i,n)=>i in s?oe(s,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[i]=n,N=(s,i)=>{for(var n in i||(i={}))X.call(i,n)&&G(s,n,i[n]);if($)for(var n of $(i))J.call(i,n)&&G(s,n,i[n]);return s},S=(s,i)=>me(s,he(i));var M=(s,i)=>{var n={};for(var o in s)X.call(s,o)&&i.indexOf(o)<0&&(n[o]=s[o]);if(s!=null&&$)for(var o of $(s))i.indexOf(o)<0&&J.call(s,o)&&(n[o]=s[o]);return n};var u=(s,i,n)=>new Promise((o,j)=>{var v=y=>{try{m(n.next(y))}catch(r){j(r)}},k=y=>{try{m(n.throw(y))}catch(r){j(r)}},m=y=>y.done?o(y.value):Promise.resolve(y.value).then(v,k);m((n=n.apply(s,i)).next())});import{j as e,x as ee,v as te,X as se,y as ae,B as Q,z as Z,C as ue,h as xe,m as ge}from"./ui-vendor-BJJ7qMNn.js";import{r as h}from"./react-vendor-ClLnrwvH.js";import{e as re,h as ve,f as je,u as ie,C as F,a as z,b as L,c as ne,d as E,B as w,U as _}from"./index-Cr9STeZ2.js";import{a as O,B as H}from"./booking-BFbKruZE.js";import{A as Y,a as U}from"./alert-C3dhOqAy.js";import{T as ye,a as pe,b as q,c as V}from"./tabs-DjhzEYjW.js";import"./utils-vendor-1hodNj4h.js";const be=(s,i,n)=>u(void 0,null,function*(){return(yield O.get("/availability",{params:{userId:s,startDate:i,endDate:n}})).data}),fe=()=>u(void 0,null,function*(){return(yield O.get("/availability/recurring")).data}),De=s=>u(void 0,null,function*(){return(yield O.post("/availability/recurring",s)).data}),Ne=(s,i)=>u(void 0,null,function*(){return(yield O.put(`/availability/recurring/${s}`,i)).data}),we=s=>u(void 0,null,function*(){yield O.delete(`/availability/recurring/${s}`)}),Te=(s,i)=>u(void 0,null,function*(){return(yield O.get("/availability/overrides",{params:{startDate:s,endDate:i}})).data}),Ae=s=>u(void 0,null,function*(){return(yield O.post("/availability/overrides",s)).data}),ke=(s,i)=>u(void 0,null,function*(){return(yield O.put(`/availability/overrides/${s}`,i)).data}),Se=s=>u(void 0,null,function*(){yield O.delete(`/availability/overrides/${s}`)}),W=()=>{const[s,i]=h.useState(null),[n,o]=h.useState([]),[j,v]=h.useState([]),[k,m]=h.useState(!1),[y,r]=h.useState(null),x=h.useCallback((a,l,d)=>u(void 0,null,function*(){m(!0),r(null);try{const A=yield be(a,l,d);i(A),o(A.recurringPatterns),v(A.overrides)}catch(A){throw r(A.message||"Failed to fetch availability"),A}finally{m(!1)}}),[]),B=h.useCallback(()=>u(void 0,null,function*(){m(!0),r(null);try{const a=yield fe();o(a)}catch(a){throw r(a.message||"Failed to fetch recurring patterns"),a}finally{m(!1)}}),[]),T=h.useCallback((a,l)=>u(void 0,null,function*(){m(!0),r(null);try{const d=yield Te(a,l);v(d)}catch(d){throw r(d.message||"Failed to fetch overrides"),d}finally{m(!1)}}),[]),p=h.useCallback(a=>u(void 0,null,function*(){m(!0),r(null);try{const l=yield De(a);o(d=>[...d,l])}catch(l){throw r(l.message||"Failed to create recurring pattern"),l}finally{m(!1)}}),[]),f=h.useCallback((a,l)=>u(void 0,null,function*(){m(!0),r(null);try{const d=yield Ne(a,l);o(A=>A.map(D=>D.id===a?d:D))}catch(d){throw r(d.message||"Failed to update recurring pattern"),d}finally{m(!1)}}),[]),t=h.useCallback(a=>u(void 0,null,function*(){m(!0),r(null);try{yield we(a),o(l=>l.filter(d=>d.id!==a))}catch(l){throw r(l.message||"Failed to delete recurring pattern"),l}finally{m(!1)}}),[]),c=h.useCallback(a=>u(void 0,null,function*(){m(!0),r(null);try{const l=yield Ae(a);v(d=>[...d,l])}catch(l){throw r(l.message||"Failed to create override"),l}finally{m(!1)}}),[]),g=h.useCallback((a,l)=>u(void 0,null,function*(){m(!0),r(null);try{const d=yield ke(a,l);v(A=>A.map(D=>D.id===a?d:D))}catch(d){throw r(d.message||"Failed to update override"),d}finally{m(!1)}}),[]),b=h.useCallback(a=>u(void 0,null,function*(){m(!0),r(null);try{yield Se(a),v(l=>l.filter(d=>d.id!==a))}catch(l){throw r(l.message||"Failed to delete override"),l}finally{m(!1)}}),[]),C=h.useCallback(()=>{r(null)},[]);return{availability:s,recurringPatterns:n,overrides:j,loading:k,error:y,fetchAvailability:x,fetchRecurringPatterns:B,fetchOverrides:T,createRecurringPattern:p,updateRecurringPattern:f,deleteRecurringPattern:t,createOverride:c,updateOverride:g,deleteOverride:b,clearError:C}};var I=(s=>(s[s.SUNDAY=0]="SUNDAY",s[s.MONDAY=1]="MONDAY",s[s.TUESDAY=2]="TUESDAY",s[s.WEDNESDAY=3]="WEDNESDAY",s[s.THURSDAY=4]="THURSDAY",s[s.FRIDAY=5]="FRIDAY",s[s.SATURDAY=6]="SATURDAY",s))(I||{});const K=s=>I[s],P=h.forwardRef((j,o)=>{var v=j,{className:s,type:i}=v,n=M(v,["className","type"]);return e.jsx("input",N({type:i,className:re("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:o},n))});P.displayName="Input";var Ce=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Re=Ce.reduce((s,i)=>{const n=ve(`Primitive.${i}`),o=h.forwardRef((j,v)=>{const r=j,{asChild:k}=r,m=M(r,["asChild"]),y=k?n:i;return typeof window!="undefined"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(y,S(N({},m),{ref:v}))});return o.displayName=`Primitive.${i}`,S(N({},s),{[i]:o})},{}),Oe="Label",le=h.forwardRef((s,i)=>e.jsx(Re.label,S(N({},s),{ref:i,onMouseDown:n=>{var j;n.target.closest("button, input, select, textarea")||((j=s.onMouseDown)==null||j.call(s,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}})));le.displayName=Oe;var ce=le;const Be=je("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),R=h.forwardRef((o,n)=>{var j=o,{className:s}=j,i=M(j,["className"]);return e.jsx(ce,N({ref:n,className:re(Be(),s)},i))});R.displayName=ce.displayName;const Fe=({onPatternChange:s})=>{const{recurringPatterns:i,loading:n,error:o,fetchRecurringPatterns:j,createRecurringPattern:v,updateRecurringPattern:k,deleteRecurringPattern:m,clearError:y}=W(),{user:r}=ie(),[x,B]=h.useState(null),[T,p]=h.useState(!1),[f,t]=h.useState({dayOfWeek:I.MONDAY,startTime:"09:00",endTime:"17:00"});h.useEffect(()=>{j()},[j]);const c=a=>u(void 0,null,function*(){a.preventDefault();try{yield v(f),p(!1),t({dayOfWeek:I.MONDAY,startTime:"09:00",endTime:"17:00"}),r&&s&&s()}catch(l){}}),g=a=>u(void 0,null,function*(){try{yield k(a.id,{isActive:!a.isActive}),r&&s&&s()}catch(l){}}),b=a=>u(void 0,null,function*(){if(window.confirm("Are you sure you want to delete this availability pattern?"))try{yield m(a),r&&s&&s()}catch(l){}}),C=i.reduce((a,l)=>{const d=l.dayOfWeek;return a[d]||(a[d]=[]),a[d].push(l),a},{});return e.jsxs(F,{children:[e.jsxs(z,{children:[e.jsx(L,{children:"Weekly Availability"}),e.jsx(ne,{children:"Set your recurring weekly availability patterns"})]}),e.jsxs(E,{children:[o&&e.jsxs(Y,{variant:"destructive",className:"mb-4",children:[e.jsx(U,{children:o}),e.jsx(w,{variant:"ghost",size:"sm",onClick:y,children:"Dismiss"})]}),!T&&e.jsxs(w,{onClick:()=>p(!0),className:"mb-4",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Add Availability Pattern"]}),T&&e.jsx("form",{onSubmit:c,className:"mb-6 p-4 border rounded-lg",children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx(R,{htmlFor:"dayOfWeek",children:"Day of Week"}),e.jsx("select",{id:"dayOfWeek",value:f.dayOfWeek,onChange:a=>t(S(N({},f),{dayOfWeek:parseInt(a.target.value)})),className:"w-full p-2 border rounded",children:Object.entries(I).filter(([a,l])=>typeof l=="number").map(([a,l])=>e.jsx("option",{value:l,children:K(l)},l))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(R,{htmlFor:"startTime",children:"Start Time"}),e.jsx(P,{id:"startTime",type:"time",value:f.startTime,onChange:a=>t(S(N({},f),{startTime:a.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx(R,{htmlFor:"endTime",children:"End Time"}),e.jsx(P,{id:"endTime",type:"time",value:f.endTime,onChange:a=>t(S(N({},f),{endTime:a.target.value})),required:!0})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(w,{type:"submit",disabled:n,children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"Add Pattern"]}),e.jsxs(w,{type:"button",variant:"outline",onClick:()=>p(!1),children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"Cancel"]})]})]})}),e.jsx("div",{className:"space-y-4",children:[0,1,2,3,4,5,6].map(a=>{const l=C[a]||[];return l.length===0?null:e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:K(a)}),e.jsx("div",{className:"space-y-2",children:l.map(d=>e.jsxs("div",{className:`flex items-center justify-between p-3 rounded ${d.isActive?"bg-green-50":"bg-gray-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"font-mono",children:[d.startTime," - ",d.endTime]}),!d.isActive&&e.jsx("span",{className:"text-sm text-gray-500",children:"(Inactive)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{variant:"outline",size:"sm",onClick:()=>g(d),disabled:n,children:d.isActive?"Deactivate":"Activate"}),e.jsx(w,{variant:"destructive",size:"sm",onClick:()=>b(d.id),disabled:n,children:e.jsx(ae,{className:"w-4 h-4"})})]})]},d.id))})]},a)})}),i.length===0&&!T&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:'No availability patterns set. Click "Add Availability Pattern" to get started.'})]})]})},Ee=()=>{const{overrides:s,loading:i,error:n,fetchOverrides:o,createOverride:j,deleteOverride:v,clearError:k}=W(),[m,y]=h.useState(!1),[r,x]=h.useState({overrideDate:"",startTime:"",endTime:"",isBlocked:!0,reason:""});h.useEffect(()=>{const t=new Date().toISOString().split("T")[0],c=new Date;c.setDate(c.getDate()+90);const g=c.toISOString().split("T")[0];o(t,g)},[o]);const B=t=>u(void 0,null,function*(){t.preventDefault();try{yield j({overrideDate:r.overrideDate,startTime:r.startTime||void 0,endTime:r.endTime||void 0,isBlocked:r.isBlocked,reason:r.reason||void 0}),y(!1),x({overrideDate:"",startTime:"",endTime:"",isBlocked:!0,reason:""})}catch(c){}}),T=t=>u(void 0,null,function*(){if(window.confirm("Are you sure you want to delete this override?"))try{yield v(t)}catch(c){}}),p=t=>new Date(t).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}),f=[...s].sort((t,c)=>new Date(t.overrideDate).getTime()-new Date(c.overrideDate).getTime());return e.jsxs(F,{children:[e.jsxs(z,{children:[e.jsx(L,{children:"Availability Overrides"}),e.jsx(ne,{children:"Block or add availability for specific dates"})]}),e.jsxs(E,{children:[n&&e.jsxs(Y,{variant:"destructive",className:"mb-4",children:[e.jsx(U,{children:n}),e.jsx(w,{variant:"ghost",size:"sm",onClick:k,children:"Dismiss"})]}),!m&&e.jsxs(w,{onClick:()=>y(!0),className:"mb-4",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Add Override"]}),m&&e.jsx("form",{onSubmit:B,className:"mb-6 p-4 border rounded-lg",children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx(R,{htmlFor:"overrideDate",children:"Date"}),e.jsx(P,{id:"overrideDate",type:"date",value:r.overrideDate,onChange:t=>x(S(N({},r),{overrideDate:t.target.value})),min:new Date().toISOString().split("T")[0],required:!0})]}),e.jsxs("div",{children:[e.jsx(R,{children:"Type"}),e.jsxs("div",{className:"flex gap-4 mt-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"isBlocked",checked:r.isBlocked,onChange:()=>x(S(N({},r),{isBlocked:!0}))}),e.jsx(Q,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{children:"Block (Not Available)"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"isBlocked",checked:!r.isBlocked,onChange:()=>x(S(N({},r),{isBlocked:!1}))}),e.jsx(Z,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Add (Available)"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(R,{htmlFor:"startTime",children:"Start Time (optional)"}),e.jsx(P,{id:"startTime",type:"time",value:r.startTime,onChange:t=>x(S(N({},r),{startTime:t.target.value}))})]}),e.jsxs("div",{children:[e.jsx(R,{htmlFor:"endTime",children:"End Time (optional)"}),e.jsx(P,{id:"endTime",type:"time",value:r.endTime,onChange:t=>x(S(N({},r),{endTime:t.target.value}))})]})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Leave times empty to apply to the entire day"}),e.jsxs("div",{children:[e.jsx(R,{htmlFor:"reason",children:"Reason (optional)"}),e.jsx(P,{id:"reason",type:"text",placeholder:"e.g., Vacation, Conference, etc.",value:r.reason,onChange:t=>x(S(N({},r),{reason:t.target.value}))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(w,{type:"submit",disabled:i,children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"Add Override"]}),e.jsxs(w,{type:"button",variant:"outline",onClick:()=>y(!1),children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"Cancel"]})]})]})}),e.jsx("div",{className:"space-y-3",children:f.map(t=>e.jsx("div",{className:`p-4 rounded-lg border ${t.isBlocked?"bg-red-50 border-red-200":"bg-green-50 border-green-200"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.isBlocked?e.jsx(Q,{className:"w-5 h-5 text-red-600"}):e.jsx(Z,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"font-semibold",children:t.isBlocked?"Blocked":"Available"})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Date:"})," ",p(t.overrideDate)]}),(t.startTime||t.endTime)&&e.jsxs("div",{children:[e.jsx("strong",{children:"Time:"})," ",t.startTime||"00:00"," -"," ",t.endTime||"23:59"]}),t.reason&&e.jsxs("div",{children:[e.jsx("strong",{children:"Reason:"})," ",t.reason]})]})]}),e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>T(t.id),disabled:i,children:e.jsx(ae,{className:"w-4 h-4 text-red-600"})})]})},t.id))}),s.length===0&&!m&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:'No overrides set. Click "Add Override" to block or add availability for specific dates.'})]})]})},Pe=({slots:s,startDate:i,endDate:n,bookings:o=[]})=>{const v=(()=>{const t=[],c=new Date(i);for(;c<=n;)t.push(new Date(c)),c.setDate(c.getDate()+1);return t})(),k=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],m=s.reduce((t,c)=>{const g=new Date(c.date).toISOString().split("T")[0];return t[g]||(t[g]=[]),t[g].push(c),t},{}),y=o.reduce((t,c)=>{try{const g=new Date(c.scheduledDatetime);if(isNaN(g.getTime()))return console.warn("Invalid booking date:",c.scheduledDatetime,c.id),t;const b=g.toISOString().split("T")[0],C=new Date(g);C.setMinutes(C.getMinutes()+(c.durationMinutes||60));const a=d=>{const A=String(d.getHours()).padStart(2,"0"),D=String(d.getMinutes()).padStart(2,"0");return`${A}:${D}`},l={date:b,startTime:a(g),endTime:a(C),isAvailable:!1,source:"override",reason:`${c.departureAirport} â†’ ${c.arrivalAirport}`};t[b]||(t[b]=[]),t[b].push(l)}catch(g){console.error("Error processing booking for calendar:",c.id,g)}return t},{}),r={};Object.keys(m).forEach(t=>{r[t]=[...m[t]]}),Object.keys(y).forEach(t=>{r[t]||(r[t]=[]),r[t].push(...y[t])});const x=t=>t.toISOString().split("T")[0],B=t=>{const c=new Date;return t.getDate()===c.getDate()&&t.getMonth()===c.getMonth()&&t.getFullYear()===c.getFullYear()},T=[];let p=[];const f=v[0].getDay();for(let t=0;t<f;t++){const c=new Date(v[0]);c.setDate(c.getDate()-(f-t)),p.push(c)}if(v.forEach(t=>{p.push(t),p.length===7&&(T.push(p),p=[])}),p.length>0){for(;p.length<7;){const t=p[p.length-1],c=new Date(t);c.setDate(c.getDate()+1),p.push(c)}T.push(p)}return e.jsxs(F,{children:[e.jsx(z,{children:e.jsx(L,{children:"Availability Calendar"})}),e.jsxs(E,{children:[e.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[k.map(t=>e.jsx("div",{className:"text-center font-semibold p-2 text-sm",children:t},t)),T.map((t,c)=>t.map((g,b)=>{const C=x(g),a=r[C]||[],l=g>=i&&g<=n,d=a.filter(D=>D.isAvailable),A=a.filter(D=>!D.isAvailable);return e.jsxs("div",{className:`
                    min-h-[100px] p-2 border rounded-lg
                    ${l?"":"bg-gray-50 text-gray-400"}
                    ${B(g)?"ring-2 ring-blue-500":""}
                    ${l&&d.length>0?"bg-green-50":""}
                    ${l&&d.length===0&&a.length===0?"bg-gray-50":""}
                    ${l&&A.length>0&&d.length===0?"bg-red-50":""}
                  `,children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:g.getDate()}),l&&a.length>0&&e.jsxs("div",{className:"space-y-1",children:[a.slice(0,3).map((D,de)=>e.jsxs("div",{className:`text-xs p-1 rounded ${D.isAvailable?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[e.jsxs("div",{className:"font-mono text-[10px]",children:[D.startTime," - ",D.endTime]}),D.reason&&e.jsx("div",{className:"truncate font-semibold",title:D.reason,children:D.reason})]},de)),a.length>3&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",a.length-3," more"]})]})]},`${c}-${b}`)}))]}),e.jsxs("div",{className:"mt-6 flex gap-6 justify-center text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-100 border border-green-200 rounded"}),e.jsx("span",{children:"Available"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-red-100 border border-red-200 rounded"}),e.jsx("span",{children:"Blocked"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-100 border border-gray-200 rounded"}),e.jsx("span",{children:"No Pattern Set"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-500 rounded"}),e.jsx("span",{children:"Today"})]})]})]})]})},qe=()=>{const{user:s}=ie(),{availability:i,loading:n,error:o,fetchAvailability:j,clearError:v}=W(),[k,m]=h.useState([]),[y,r]=h.useState(!1),[x,B]=h.useState({startDate:new Date().toISOString().split("T")[0],endDate:(()=>{const t=new Date;return t.setDate(t.getDate()+30),t.toISOString().split("T")[0]})()});h.useEffect(()=>{s&&(T(),p())},[s,x]);const T=()=>{s&&j(s.id,x.startDate,x.endDate)},p=()=>u(void 0,null,function*(){if(s)try{r(!0);let t=[];s.role===_.INSTRUCTOR?t=yield H.listBookings({instructorId:s.id,startDate:x.startDate,endDate:x.endDate,limit:1e3}):s.role===_.STUDENT?t=yield H.listBookings({studentId:s.id,startDate:x.startDate,endDate:x.endDate,limit:1e3}):(s.role==="ADMIN"||s.role==="admin")&&(t=yield H.listBookings({startDate:x.startDate,endDate:x.endDate,limit:1e3})),m(t)}catch(t){console.error("Failed to load bookings for availability calendar:",t)}finally{r(!1)}}),f=t=>{const c=new Date,g=c.toISOString().split("T")[0];let b;switch(t){case"week":b=new Date(c),b.setDate(b.getDate()+7);break;case"month":b=new Date(c),b.setDate(b.getDate()+30);break;case"3months":b=new Date(c),b.setDate(b.getDate()+90);break}B({startDate:g,endDate:b.toISOString().split("T")[0]})};return s?e.jsxs("div",{className:"container mx-auto py-8 px-4",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Availability Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage your weekly recurring availability and one-time overrides"})]}),o&&e.jsxs(Y,{variant:"destructive",className:"mb-4",children:[e.jsx(U,{children:o}),e.jsx(w,{variant:"ghost",size:"sm",onClick:v,children:"Dismiss"})]}),e.jsxs(ye,{defaultValue:"calendar",className:"space-y-6",children:[e.jsxs(pe,{className:"grid w-full grid-cols-3 max-w-md",children:[e.jsxs(q,{value:"calendar",children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),"Calendar"]}),e.jsxs(q,{value:"recurring",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Weekly"]}),e.jsxs(q,{value:"overrides",children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Overrides"]})]}),e.jsxs(V,{value:"calendar",className:"space-y-6",children:[e.jsxs(F,{children:[e.jsx(z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(L,{children:"Availability Overview"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{variant:"outline",size:"sm",onClick:()=>f("week"),children:"1 Week"}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>f("month"),children:"1 Month"}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>f("3months"),children:"3 Months"})]})]})}),e.jsx(E,{children:n?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"})}):i?e.jsx(Pe,{slots:i.slots,startDate:new Date(x.startDate),endDate:new Date(x.endDate),bookings:k}):e.jsx("div",{className:"text-center py-12 text-gray-500",children:"No availability data to display"})})]}),i&&e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(F,{children:e.jsx(E,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:i.slots.filter(t=>t.isAvailable).length}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Available Slots"})]})})}),e.jsx(F,{children:e.jsx(E,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:i.recurringPatterns.filter(t=>t.isActive).length}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Active Patterns"})]})})}),e.jsx(F,{children:e.jsx(E,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-red-600",children:i.overrides.filter(t=>t.isBlocked).length}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Blocked Days"})]})})})]})]}),e.jsx(V,{value:"recurring",children:e.jsx(Fe,{onPatternChange:T})}),e.jsx(V,{value:"overrides",children:e.jsx(Ee,{})})]})]}):e.jsx(Y,{children:e.jsx(U,{children:"Please log in to manage your availability."})})};export{qe as AvailabilityCalendar};
