var y=(s,a,r)=>new Promise((n,i)=>{var d=c=>{try{m(r.next(c))}catch(N){i(N)}},t=c=>{try{m(r.throw(c))}catch(N){i(N)}},m=c=>c.done?n(c.value):Promise.resolve(c.value).then(d,t);m((r=r.apply(s,a)).next())});import{j as e,e as A,f as T,T as L,P as v,U as D,g as b,h as E,i as R,k as P,l as O,d as $,R as z}from"./ui-vendor-BJJ7qMNn.js";import{r as g,c as V}from"./react-vendor-ClLnrwvH.js";import{C as h,a as x,b as p,c as j,d as o,B as f,u as _}from"./index-BwQCZXI4.js";import{B as l}from"./badge-Ca4ZlOJv.js";import{p as w,f as H,b as G,i as K,c as Q}from"./utils-vendor-1hodNj4h.js";function q(s){const a=s.toLowerCase();return a.includes("clear")||a.includes("sunny")?"‚òÄÔ∏è":a.includes("cloud")?"‚òÅÔ∏è":a.includes("rain")?"üåßÔ∏è":a.includes("snow")?"‚ùÑÔ∏è":a.includes("fog")||a.includes("mist")?"üå´Ô∏è":a.includes("thunder")||a.includes("storm")?"‚õàÔ∏è":a.includes("wind")?"üí®":"üå§Ô∏è"}function J(s,a,r,n){const i=n.toLowerCase();return s<3||a>25||r<1e3||i.includes("thunder")||i.includes("ice")||i.includes("severe")?"unsafe":s<5||a>15||r<3e3||i.includes("rain")||i.includes("fog")?"caution":"safe"}function X(s){switch(s){case"safe":return"text-green-600 bg-green-50 border-green-200";case"caution":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"unsafe":return"text-red-600 bg-red-50 border-red-200"}}function I(s,a="MMM d, yyyy h:mm a"){const r=typeof s=="string"?w(s):s;return H(r,a)}function W(s){const a=typeof s=="string"?w(s):s;return G(a,new Date,{addSuffix:!0})}function Y(s){const a=typeof s=="string"?w(s):s;return K(a)}function Z(s){const a=typeof s=="string"?w(s):s;return Q(a)}function ee({alerts:s=[],loading:a=!1}){const[r,n]=g.useState(s);g.useEffect(()=>{n(s)},[s]);const i=t=>{switch(t){case"critical":return e.jsx(L,{className:"h-5 w-5 text-red-600"});case"warning":return e.jsx(T,{className:"h-5 w-5 text-yellow-600"});case"info":return e.jsx(A,{className:"h-5 w-5 text-blue-600"});default:return e.jsx(T,{className:"h-5 w-5 text-gray-600"})}},d=t=>{switch(t){case"critical":return e.jsx(l,{className:"bg-red-500",children:"Critical"});case"warning":return e.jsx(l,{className:"bg-yellow-500",children:"Warning"});case"info":return e.jsx(l,{className:"bg-blue-500",children:"Info"});default:return e.jsx(l,{variant:"outline",children:"Unknown"})}};return a?e.jsxs(h,{children:[e.jsxs(x,{children:[e.jsx(p,{children:"Weather Alerts"}),e.jsx(j,{children:"Loading weather alerts..."})]}),e.jsx(o,{children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-pulse text-gray-400",children:"Loading..."})})})]}):r.length===0?e.jsxs(h,{children:[e.jsxs(x,{children:[e.jsx(p,{children:"Weather Alerts"}),e.jsx(j,{children:"All flights are clear of weather conflicts"})]}),e.jsx(o,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-green-600",children:[e.jsx(A,{className:"h-12 w-12 mb-3"}),e.jsx("p",{className:"font-medium",children:"No Active Weather Alerts"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"All upcoming flights meet weather minimums"})]})})]}):e.jsxs(h,{children:[e.jsx(x,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(p,{children:"Weather Alerts"}),e.jsxs(j,{children:[r.length," active alert",r.length>1?"s":""]})]}),e.jsx(l,{variant:"outline",className:"text-lg px-3 py-1",children:r.length})]})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-3",children:r.map(t=>{const m=J(t.weather.visibility,t.weather.windSpeed,t.weather.ceiling,t.weather.conditions),c=X(m);return e.jsxs("div",{className:`border rounded-lg p-4 ${c}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[i(t.severity),e.jsx("h4",{className:"font-semibold",children:t.flightInfo.route})]}),d(t.severity)]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Scheduled:"}),e.jsx("p",{className:"font-medium",children:I(t.flightInfo.scheduledTime)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Training Level:"}),e.jsx("p",{className:"font-medium",children:t.flightInfo.trainingLevel})]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[q(t.weather.conditions),e.jsx("span",{className:"font-medium",children:t.weather.conditions})]}),e.jsxs("span",{children:["Vis: ",t.weather.visibility,"mi"]}),e.jsxs("span",{children:["Wind: ",t.weather.windSpeed,"kt"]}),e.jsxs("span",{children:["Ceiling: ",t.weather.ceiling,"ft"]})]}),e.jsxs("p",{className:"text-xs text-gray-600 mt-2",children:["Detected ",W(t.detectedAt)]})]},t.id)})})})]})}function se({bookings:s=[],loading:a=!1,onViewDetails:r}){const n=t=>{switch(t){case"CONFIRMED":return e.jsx(l,{className:"bg-green-500",children:"Confirmed"});case"AT_RISK":return e.jsx(l,{className:"bg-yellow-500",children:"At Risk"});case"CANCELLED":return e.jsx(l,{className:"bg-gray-500",children:"Cancelled"});case"PENDING_RESCHEDULE":return e.jsx(l,{className:"bg-blue-500",children:"Pending Reschedule"});case"ESCALATED":return e.jsx(l,{className:"bg-red-500",children:"Escalated"});default:return e.jsx(l,{variant:"outline",children:t})}},i=t=>{switch(t){case"CONFIRMED":return e.jsx(R,{className:"h-5 w-5 text-green-600"});case"AT_RISK":return e.jsx(b,{className:"h-5 w-5 text-yellow-600"});case"CANCELLED":return e.jsx(b,{className:"h-5 w-5 text-gray-600"});case"PENDING_RESCHEDULE":return e.jsx(E,{className:"h-5 w-5 text-blue-600"});case"ESCALATED":return e.jsx(b,{className:"h-5 w-5 text-red-600"});default:return e.jsx(v,{className:"h-5 w-5 text-gray-600"})}},d=t=>Y(t)?e.jsx(l,{variant:"outline",className:"text-blue-600 border-blue-600",children:"Today"}):Z(t)?e.jsx(l,{variant:"outline",className:"text-purple-600 border-purple-600",children:"Tomorrow"}):null;return a?e.jsxs(h,{children:[e.jsxs(x,{children:[e.jsx(p,{children:"Flight Status"}),e.jsx(j,{children:"Loading bookings..."})]}),e.jsx(o,{children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-pulse text-gray-400",children:"Loading..."})})})]}):s.length===0?e.jsxs(h,{children:[e.jsxs(x,{children:[e.jsx(p,{children:"Flight Status"}),e.jsx(j,{children:"No upcoming flights scheduled"})]}),e.jsx(o,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-gray-600",children:[e.jsx(v,{className:"h-12 w-12 mb-3"}),e.jsx("p",{className:"font-medium",children:"No Upcoming Flights"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Schedule a new flight to get started"})]})})]}):e.jsxs(h,{children:[e.jsx(x,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(p,{children:"Flight Status"}),e.jsxs(j,{children:[s.length," upcoming flight",s.length>1?"s":""]})]})})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-3",children:s.map(t=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[i(t.status),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("h4",{className:"font-semibold",children:[t.departureAirport," ‚Üí ",t.arrivalAirport]}),d(t.scheduledTime)]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[I(t.scheduledTime)," (",W(t.scheduledTime),")"]})]})]}),n(t.status)]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Student"}),e.jsx("p",{className:"font-medium",children:t.studentName})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Instructor"}),e.jsx("p",{className:"font-medium",children:t.instructorName})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-4 text-gray-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(v,{className:"h-4 w-4"}),t.aircraftType]}),e.jsx(l,{variant:"outline",children:t.trainingLevel})]}),r&&e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>r(t.id),children:"View Details"})]})]},t.id))})})]})}const te=[{label:"Total Flights",value:0,icon:e.jsx(v,{className:"h-5 w-5 text-blue-600"}),description:"Scheduled this month"},{label:"Active Alerts",value:0,icon:e.jsx(L,{className:"h-5 w-5 text-yellow-600"}),description:"Weather conflicts detected"},{label:"Successful Reschedules",value:0,icon:e.jsx(R,{className:"h-5 w-5 text-green-600"}),description:"Completed this month"},{label:"Avg Response Time",value:"--",icon:e.jsx(E,{className:"h-5 w-5 text-purple-600"}),description:"Preference submission time"}];function ae({metrics:s=te,loading:a=!1}){const r=i=>{switch(i){case"up":return e.jsx(O,{className:"h-4 w-4 text-green-600"});case"down":return e.jsx(P,{className:"h-4 w-4 text-red-600"});default:return null}},n=i=>{switch(i){case"up":return"text-green-600";case"down":return"text-red-600";default:return"text-gray-600"}};return a?e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[1,2,3,4].map(i=>e.jsxs(h,{children:[e.jsx(x,{className:"pb-2",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-24"})}),e.jsxs(o,{children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded animate-pulse w-16 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-32"})]})]},i))}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:s.map((i,d)=>e.jsxs(h,{children:[e.jsx(x,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(j,{className:"text-sm font-medium",children:i.label}),i.icon]})}),e.jsxs(o,{children:[e.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[e.jsx("div",{className:"text-2xl font-bold",children:i.value}),i.change&&e.jsxs("div",{className:`flex items-center text-sm ${n(i.change.trend)}`,children:[r(i.change.trend),e.jsxs("span",{className:"ml-1",children:[i.change.value>0?"+":"",i.change.value,"%"]})]})]}),i.description&&e.jsx("p",{className:"text-xs text-gray-600",children:i.description})]})]},d))})}function ie({size:s="md",text:a,fullScreen:r=!1}){const n={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"},i=e.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[e.jsx($,{className:`${n[s]} animate-spin text-blue-600`}),a&&e.jsx("p",{className:"text-sm text-gray-600",children:a})]});return r?e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-white bg-opacity-75 z-50",children:i}):i}function xe(){const{user:s}=_(),a=V(),[r,n]=g.useState(!0),[i,d]=g.useState(!1),[t,m]=g.useState(new Date),[c,N]=g.useState({metrics:[],weatherAlerts:[],bookings:[]});g.useEffect(()=>{C();const u=setInterval(()=>{S()},5*60*1e3);return()=>clearInterval(u)},[]);const C=()=>y(this,null,function*(){try{n(!0),yield new Promise(u=>setTimeout(u,1e3)),N({metrics:[{label:"Total Flights",value:24,change:{value:12,trend:"up"},description:"Scheduled this month"},{label:"Active Alerts",value:3,change:{value:-25,trend:"down"},description:"Weather conflicts detected"},{label:"Successful Reschedules",value:18,change:{value:8,trend:"up"},description:"Completed this month"},{label:"Avg Response Time",value:"4.2h",change:{value:-15,trend:"down"},description:"Preference submission time"}],weatherAlerts:[],bookings:[]}),m(new Date)}catch(u){console.error("Failed to load dashboard data:",u)}finally{n(!1)}}),S=()=>y(this,null,function*(){try{d(!0),yield C()}finally{d(!1)}}),k=u=>{a(`/bookings/${u}`)},F=()=>{a("/bookings/new")},B=()=>{a("/availability")},U=()=>{a("/bookings")},M=()=>{a("/settings")};return r?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(ie,{size:"lg",text:"Loading dashboard..."})}):e.jsxs("div",{children:[e.jsx("div",{className:"bg-white border-b",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Welcome back, ",(s==null?void 0:s.name)||`${(s==null?void 0:s.firstName)||""} ${(s==null?void 0:s.lastName)||""}`.trim()||"User"]})]}),e.jsxs(f,{variant:"outline",size:"sm",onClick:S,disabled:i,children:[e.jsx(z,{className:`h-4 w-4 mr-2 ${i?"animate-spin":""}`}),"Refresh"]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Last updated: ",t.toLocaleTimeString()]})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 space-y-6",children:[e.jsx(ae,{metrics:c.metrics}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsx(ee,{alerts:c.weatherAlerts}),e.jsx(se,{bookings:c.bookings,onViewDetails:k})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[e.jsx(f,{onClick:F,children:"Schedule New Flight"}),e.jsx(f,{variant:"outline",onClick:B,children:"Manage Availability"}),e.jsx(f,{variant:"outline",onClick:U,children:"View All Bookings"}),e.jsx(f,{variant:"outline",onClick:M,children:"System Settings"})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-blue-800",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-600 rounded-full animate-pulse"}),e.jsx("p",{className:"text-sm font-medium",children:"Weather monitoring active ‚Ä¢ Checking every 10 minutes"})]})})]})]})}export{xe as Dashboard};
